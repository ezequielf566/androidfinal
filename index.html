<!-- ðŸ”¸ Pintando a Palavra â€” Menu FINAL (com AtualizaÃ§Ã£o + Modal fixo e Header responsivo) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Pintando a Palavra â€” Menu</title>
<link rel="manifest" href="/manifest.json" />
<meta name="theme-color" content="#ffffff" />
<style>
body{
  margin:0;font-family:"Fredoka",sans-serif;color:#222;min-height:100vh;
  display:flex;flex-direction:column;
  background:linear-gradient(180deg,#fff7d1 0%,#fff3bf 40%,#fff9e6 100%);
  background-attachment:fixed;overflow-x:hidden;
}
header{
  background:linear-gradient(90deg,#ffd54f,#ffea80);
  padding:.8rem 1rem;
  display:flex;justify-content:space-between;align-items:center;
  box-shadow:0 2px 8px rgba(0,0,0,.15);
  border-bottom-left-radius:12px;border-bottom-right-radius:12px;
  position:sticky;top:0;z-index:50;
}
.left-icons{
  display:flex;align-items:center;gap:10px;flex-wrap:nowrap;min-width:0;
}
.right-buttons{
  display:flex;align-items:center;gap:8px;flex-shrink:0;
}
.notif-icon,.update-icon{
  cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.2s;
}
.notif-icon:hover svg,.update-icon:hover svg,.diamond:hover{transform:scale(1.1);}
.notif-icon svg,.update-icon svg{
  width:26px;height:26px;stroke:#444;
  filter:drop-shadow(0 0 4px rgba(255,213,79,0.6));
}
.diamond{
  font-size:1.5rem;cursor:pointer;
  animation:spinDiamond 3.5s linear infinite;
  display:flex;align-items:center;justify-content:center;
}
@keyframes spinDiamond{
  0%{transform:rotateY(0deg);}
  50%{transform:rotateY(180deg);}
  100%{transform:rotateY(360deg);}
}
.update-alert{
  background:#fffbe6;color:#333;padding:6px 12px;border-radius:10px;
  font-weight:600;font-family:'Fredoka',sans-serif;box-shadow:0 2px 6px rgba(0,0,0,0.2);
  opacity:0;transition:opacity .4s ease;position:absolute;top:62px;left:50%;
  transform:translateX(-50%);font-size:.9rem;z-index:200;
}
.shake{animation:shake .6s ease-in-out infinite alternate;}
@keyframes shake{
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-2px);}
  75%{transform:translateX(2px);}
}
header .btn{
  background:#fff;border:none;padding:.6rem 1rem;border-radius:12px;cursor:pointer;
  font-weight:600;box-shadow:0 2px 6px rgba(0,0,0,.15);transition:.25s;
  display:flex;align-items:center;gap:5px;
}
header .btn:hover{transform:scale(1.05);background:#fff7d1;}
main{flex:1;display:flex;flex-direction:column;align-items:center;
  padding:2rem 1rem 3rem;text-align:center;}
.saudacao{
  font-size:1.6rem;color:#222;font-weight:600;margin-bottom:2rem;
  background:rgba(255,255,255,0.6);padding:1rem 1.5rem;border-radius:16px;
  box-shadow:0 4px 8px rgba(0,0,0,.1);backdrop-filter:blur(5px);
  display:inline-block;opacity:0;transition:opacity .6s ease;
}
.menu{display:flex;flex-direction:column;gap:1.2rem;width:100%;max-width:340px;}
.menu button{
  background:#ffd54f;border:none;padding:1rem;border-radius:16px;font-size:1.15rem;
  font-weight:700;cursor:pointer;box-shadow:inset 0 1px 0 rgba(255,255,255,.4),0 4px 10px rgba(0,0,0,.15);
  transition:.25s;
}
.menu button:hover{transform:scale(1.03);background:#ffe066;}
.socials{display:flex;justify-content:center;gap:1rem;margin-top:1.5rem;}
.socials button{
  background:#fffbe6;border:2px solid #ffe066;border-radius:14px;
  padding:.7rem 1.3rem;font-size:1rem;font-weight:600;cursor:pointer;
  transition:.25s;box-shadow:0 3px 6px rgba(0,0,0,.1);
}
.socials button:hover{background:#fff2b3;transform:scale(1.05);}
.modal-backdrop{
  position:fixed;inset:0;background:rgba(255,240,180,0.45);backdrop-filter:blur(4px);
  display:none;align-items:center;justify-content:center;z-index:1200;padding:16px;opacity:0;transition:.3s;
}
.modal-backdrop.open{display:flex;opacity:1;}
.modal-box{
  background:linear-gradient(180deg,#FFF8DC 0%,#FFEBA3 100%);
  border-radius:20px;padding:20px 16px;width:min(90%,420px);
  box-shadow:0 8px 24px rgba(0,0,0,0.25);text-align:center;
}
.modal-box p{color:#333;font-size:1rem;margin:0;line-height:1.4;}
</style>
</head>

<body>
<header>
  <div class="left-icons">
    <div class="notif-icon" title="HistÃ³ria do Projeto" onclick="window.openStoryModal()">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
        <path d="M3 8l9 6 9-6"></path><path d="M21 8v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8"></path>
      </svg>
    </div>
    <div class="diamond" id="diamondBtn" title="Apoiar Projeto">ðŸ’Ž</div>
    <div class="update-icon" id="updateIcon" title="Atualizar app">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
        <polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline>
        <path d="M3.51 9a9 9 0 0114.13-3.36L23 10"></path><path d="M20.49 15a9 9 0 01-14.13 3.36L1 14"></path>
      </svg>
    </div>
  </div>

  <div class="right-buttons">
    <button id="installBtn" class="btn" style="display:none;">ðŸ“² Instalar app</button>
    <button id="logoutBtn" class="btn">ðŸšª Sair</button>
  </div>
</header>

<div id="updateAlert" class="update-alert"></div>

<main>
  <div id="saudacao" class="saudacao">ðŸ‘‹ OlÃ¡! Seja bem-vindo</div>
  <div class="menu">
    <button onclick="abrirTela('app/index.html','app')">ðŸ“– HistÃ³rias</button>
    <button onclick="abrirTela('atividades/index.html','atividades')">ðŸŽ¨ Atividades</button>
    <button onclick="abrirTela('pdfcompleto/index.html','pdfcompleto')">ðŸ“š PDF Completo</button>
  </div>
  <h2>Siga-nos nas redes sociais</h2>
  <div class="socials">
    <button onclick="window.open('https://www.instagram.com/pintandoapalavra_', '_blank')">ðŸ“¸ Instagram</button>
    <button onclick="window.open('https://www.facebook.com/share/1CYaATKtFQ/', '_blank')">ðŸ“˜ Facebook</button>
  </div>
</main>

<!-- ðŸ’Ž Modal Apoiar Projeto -->
<div id="supportModal" class="modal-backdrop">
  <div class="modal-box">
    <h2>ðŸ’› Seja Premium</h2>
    <p>Remova os anÃºncios e apoie este projeto! Sua ajuda mantÃ©m tudo gratuito e alcanÃ§a mais famÃ­lias.</p>
    <div style="margin-top:1rem;display:flex;gap:.5rem;justify-content:center;">
      <button class="btn" onclick="window.closeSupportModal()">Agora nÃ£o</button>
      <button class="btn" id="btnApoiar">ðŸ’³ Apoiar agora</button>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyDN2p43zoaWoFuRcxrBMmNE8_Cm0d0ecw8",
  authDomain:"pintando-a-palavra-fnl.firebaseapp.com",
  projectId:"pintando-a-palavra-fnl",
  storageBucket:"pintando-a-palavra-fnl.firebasestorage.app",
  messagingSenderId:"394858613454",
  appId:"1:394858613454:web:68ecc607c0414bd7779e9f"
};
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const diamondBtn=document.getElementById("diamondBtn");
const logoutBtn=document.getElementById("logoutBtn");
const installBtn=document.getElementById("installBtn");
const saudacao=document.getElementById("saudacao");
const updateIcon=document.getElementById("updateIcon");
const updateAlert=document.getElementById("updateAlert");

window.openSupportModal=()=>supportModal.classList.add("open");
window.closeSupportModal=()=>supportModal.classList.remove("open");

onAuthStateChanged(auth,async(user)=>{
  if(user){
    const name=user.displayName?.split(" ")[0]||"Amigo";
    setTimeout(()=>{
      saudacao.innerHTML=`ðŸ‘‹ OlÃ¡, <strong>${name}</strong>!<br>Que bom ter vocÃª aqui ðŸ’›`;
      saudacao.style.opacity="1";
    },400);
    const ref=doc(db,"usuariosGoogle",user.email.toLowerCase());
    const snap=await getDoc(ref);
    if(snap.exists()&&snap.data().removeAds)diamondBtn.style.display="none";
  }else window.location.replace("seletor.html");
});

logoutBtn.addEventListener("click",async()=>{
  await signOut(auth);
  localStorage.clear();
  window.location.replace("seletor.html");
});

let deferredPrompt;
window.addEventListener("beforeinstallprompt",(e)=>{
  e.preventDefault();deferredPrompt=e;installBtn.style.display="flex";
});
installBtn.addEventListener("click",async()=>{
  if(deferredPrompt){deferredPrompt.prompt();
    const result=await deferredPrompt.userChoice;
    if(result.outcome==="accepted")installBtn.style.display="none";
  }
});

// ðŸ” AtualizaÃ§Ã£o com feedback e reload triplo
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("/service-worker.js").then(reg=>{
    reg.onupdatefound=()=>{
      const newWorker=reg.installing;
      newWorker.onstatechange=()=>{
        if(newWorker.state==="installed"&&navigator.serviceWorker.controller){
          updateIcon.classList.add("shake");
          updateAlert.textContent="âœ¨ Nova versÃ£o disponÃ­vel!";
          updateAlert.style.opacity="1";
        }
      };
    };
    updateIcon.addEventListener("click",()=>{
      updateAlert.textContent="ðŸ”„ AtualizaÃ§Ã£o encontrada, recarregando...";
      updateAlert.style.opacity="1";
      updateIcon.classList.remove("shake");
      let t=0;
      const reload=()=>{t++;window.location.reload();if(t<3)setTimeout(reload,2000);};
      reload();
    });
    const mover=setInterval(()=>{
      if(diamondBtn&&diamondBtn.style.display==="none"){
        updateIcon.style.marginLeft="0";clearInterval(mover);
      }
    },1000);
  });
}
</script>
</body>
</html>
